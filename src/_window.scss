/**
 * Window
 * Mac OS X Aqua-style window with titlebar and traffic light controls
 */

@use "mixins" as *;

.window {
  display: flex;
  flex-direction: column;
  border-radius: 8px 8px 0 0;
  overflow: hidden;
  font-family: var(--font-system);
  font-size: var(--font-size-base);

  /* Window border */
  border: 1px solid var(--window-border);

  /* Window shadow */
  box-shadow: var(--aqua-window-shadow);

  &.inactive {
    border-color: var(--window-border-inactive);
    box-shadow: var(--aqua-window-shadow-inactive);

    .title-bar {
      background: var(--aqua-titlebar-inactive-bg);
      border-bottom-color: var(--window-titlebar-border-inactive);
    }

    .title-bar-controls button {
      background: var(--traffic-light-inactive-gradient) !important;
      box-shadow: var(--traffic-light-inactive-shadow) !important;
    }

    .title-bar-text {
      color: var(--window-titlebar-text-inactive);
    }
  }

  &.brushed-metal {
    .window-body {
      background: var(--window-toolbar-bg);
      background-image: none;
    }
  }
}

.window-body {
  flex: 1;
  padding: 16px;
  overflow: auto;
  background: var(--window-bg);
}

/* Title Bar */
.title-bar {
  display: flex;
  align-items: center;
  height: 22px;
  padding: 0 8px;
  gap: 8px;

  /* Gradient background with pinstripes */
  background: var(--aqua-titlebar-bg);
  background-image:
    var(--aqua-pinstripe-titlebar),
    var(--aqua-titlebar-bg);

  border-bottom: 1px solid var(--window-titlebar-border);
}

.title-bar-text {
  flex: 1;
  text-align: center;
  font-size: var(--font-size-title);
  font-weight: 500;
  color: var(--window-titlebar-text);
  text-shadow: var(--window-titlebar-text-shadow);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
}

/* Spacer to center title */
.title-bar-spacer {
  width: 54px;
}

/* Traffic Light Controls */
.title-bar-controls {
  display: flex;
  gap: 8px;

  &:hover button {
    /* Show icons on hover */
    .icon {
      opacity: 1;
    }
  }

  button {
    position: relative;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    border: none;
    padding: 0;
    min-width: 0;
    min-height: 0;
    cursor: pointer;
    overflow: visible;
    transition: all 0.15s ease;
    background: none;
    font-size: 14px;

    /* Icon inside button */
    .icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -55%);
      font-size: 8px;
      font-weight: bold;
      line-height: 1;
      opacity: 0;
      z-index: 10;
      transition: opacity 0.1s ease;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    }

    /* Aqua glass effect (top shine + bottom glow) */
    @include aqua-glass('round');

    /* Close button - Red */
    &[aria-label="Close"] {
      background: var(--traffic-light-red-gradient);
      box-shadow: var(--traffic-light-red-shadow);

      .icon {
        color: var(--traffic-light-icon-red);
        text-shadow: var(--traffic-light-icon-red-shadow);
      }

      &:hover {
        background: var(--traffic-light-red-hover-gradient);
      }
    }

    /* Minimize button - Yellow */
    &[aria-label="Minimize"] {
      background: var(--traffic-light-yellow-gradient);
      box-shadow: var(--traffic-light-yellow-shadow);

      .icon {
        color: var(--traffic-light-icon-yellow);
        text-shadow: var(--traffic-light-icon-yellow-shadow);
      }

      &:hover {
        background: var(--traffic-light-yellow-hover-gradient);
      }
    }

    /* Zoom/Maximize button - Green */
    &[aria-label="Maximize"],
    &[aria-label="Zoom"] {
      background: var(--traffic-light-green-gradient);
      box-shadow: var(--traffic-light-green-shadow);

      .icon {
        color: var(--traffic-light-icon-green);
        text-shadow: var(--traffic-light-icon-green-shadow);
      }

      &:hover {
        background: var(--traffic-light-green-hover-gradient);
      }
    }

    &:active:not(:disabled) {
      filter: brightness(0.85);
    }
  }
}

/* Toolbar */
.toolbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  min-height: 32px;

  /* Brushed metal texture */
  background: var(--window-toolbar-bg);

  border-bottom: 1px solid var(--window-toolbar-border);
  box-shadow: var(--window-toolbar-shadow);
}

/* Status Bar */
.status-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  min-height: 20px;
  font-size: var(--font-size-small);
  color: var(--window-status-text);

  background: var(--window-status-bg);

  border-top: 1px solid var(--window-status-border);
  box-shadow: var(--window-status-shadow);
}

/* Sheet variant (modal attached to window) */
.window.sheet {
  border-radius: 0 0 8px 8px;
  box-shadow: var(--window-sheet-shadow);

  .title-bar {
    display: none;
  }
}

/* Utility window variant (smaller, no pinstripes) */
.window.utility {
  border-radius: 4px 4px 0 0;

  .title-bar {
    height: 16px;
    padding: 0 4px;
    gap: 4px;
  }

  .title-bar-controls button {
    width: 10px;
    height: 10px;
  }

  .title-bar-text {
    font-size: 11px;
  }

  .title-bar-spacer {
    width: 38px;
  }

  .window-body {
    background: var(--window-bg);
    background-image: none;
  }
}
