<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive macOS Spinner</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <svg width="0" height="0" style="position:absolute">
        <defs>
            <clipPath id="dynamicBlade" clipPathUnits="objectBoundingBox">
                <path id="bladePath" d="M 0.5,0.5 L 0.5,0 L 1,0 Z" />
            </clipPath>
        </defs>
    </svg>

    <div class="layout">
        <div class="preview-area">
            <!-- 1. Spinning Version -->
            <div class="spinner-wrapper">
                <span class="label">Spinning</span>
                <div class="spinner-container">
                    <div class="static-rainbow-bg"></div>
                    <div class="spinning-pinwheel">
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                    </div>
                    <div class="gloss-overlay"></div>
                    <div class="rim"></div>
                </div>
            </div>

            <!-- 2. Static Version -->
            <div class="spinner-wrapper">
                <span class="label">Static</span>
                <div class="spinner-container static-mode">
                    <div class="static-rainbow-bg"></div>
                    <div class="spinning-pinwheel">
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                        <div class="blade"></div>
                    </div>
                    <div class="gloss-overlay"></div>
                    <div class="rim"></div>
                </div>
            </div>
        </div>

        <div class="controls-area">
            <h2>Shape Editor</h2>

            <div class="control-group">
                <label for="bgSelect">Background Style</label>
                <select id="bgSelect" style="padding: 5px; border-radius: 4px; background: #EEE; border: none;">
                    <option value="bg-beach-ball">Beach Ball (Segments)</option>
                    <option value="bg-smooth-rainbow">Smooth Rainbow</option>
                </select>
            </div>

            <div class="control-group">
                <label for="widthRange">Blade Width (Gap)</label>
                <input type="range" id="widthRange" min="10" max="72" value="38">
            </div>

            <div class="control-group">
                <label for="curveRange">Curvature</label>
                <input type="range" id="curveRange" min="-0.3" max="0.3" step="0.01" value="0.24">
            </div>

            <div class="control-group">
                <label for="opacityRange">Opacity</label>
                <input type="range" id="opacityRange" min="0" max="1" step="0.01" value="0.25">
            </div>

            <div class="control-group">
                <label for="speedRange">Spin Speed</label>
                <input type="range" id="speedRange" min="0.1" max="3" step="0.1" value="1.2">
            </div>

            <div class="output-group">
                <label>Current Parameters (Copy this!)</label>
                <textarea id="outputBox" readonly></textarea>
            </div>
        </div>
    </div>

    <script>
        const bgSelect = document.getElementById('bgSelect');
        const widthRange = document.getElementById('widthRange');
        const curveRange = document.getElementById('curveRange');
        const opacityRange = document.getElementById('opacityRange');
        const speedRange = document.getElementById('speedRange');
        const outputBox = document.getElementById('outputBox');

        const bladePath = document.getElementById('bladePath');
        const pinwheels = document.querySelectorAll('.spinning-pinwheel');
        const backgrounds = document.querySelectorAll('.static-rainbow-bg');

        function updateShape() {
            // Background Update
            backgrounds.forEach(bg => {
                bg.className = 'static-rainbow-bg ' + bgSelect.value;
            });

            const widthDeg = parseFloat(widthRange.value);
            const halfWidth = widthDeg / 2;
            const curve = parseFloat(curveRange.value);
            const opacity = parseFloat(opacityRange.value);

            const cx = 0.5;
            const cy = 0.5;
            const r = 0.5;

            const startAngle = (-90 - halfWidth) * (Math.PI / 180);
            const endAngle = (-90 + halfWidth) * (Math.PI / 180);

            const x1 = cx + r * Math.cos(startAngle);
            const y1 = cy + r * Math.sin(startAngle);
            const x2 = cx + r * Math.cos(endAngle);
            const y2 = cy + r * Math.sin(endAngle);

            const cpR = 0.25;
            const curveShift = curve * Math.PI;

            const cp1x = cx + cpR * Math.cos(startAngle + curveShift);
            const cp1y = cy + cpR * Math.sin(startAngle + curveShift);

            const cp2x = cx + cpR * Math.cos(endAngle + curveShift);
            const cp2y = cy + cpR * Math.sin(endAngle + curveShift);

            const largeArc = 0;
            const sweep = 1;

            const d = `
        M ${cx},${cy}
        Q ${cp1x},${cp1y} ${x1},${y1}
        A ${r},${r} 0 ${largeArc} ${sweep} ${x2},${y2}
        Q ${cp2x},${cp2y} ${cx},${cy}
        Z
      `;

            bladePath.setAttribute('d', d.replace(/\s+/g, ' '));

            document.body.style.setProperty('--blade-opacity', opacity);

            pinwheels.forEach(pw => {
                pw.style.animationDuration = (1 / speedRange.value) + 's';
            });

            // Update Output Box
            outputBox.value = `Background: ${bgSelect.options[bgSelect.selectedIndex].text}\nBlade Width: ${widthDeg}\nCurvature: ${curve}\nOpacity: ${opacity}\nSpin Speed: ${speedRange.value}`;
        }

        bgSelect.addEventListener('change', updateShape);
        widthRange.addEventListener('input', updateShape);
        curveRange.addEventListener('input', updateShape);
        opacityRange.addEventListener('input', updateShape);
        speedRange.addEventListener('input', updateShape);

        updateShape();
    </script>

</body>

</html>