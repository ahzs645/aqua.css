// ============================================
// AquaFX Progress Bar Component
// Matches JavaFX AquaProgressBarSkin exactly
// ============================================

@use '../base/variables' as *;
@use '../base/mixins' as *;

.aqua-progress {
  width: 200px;
  height: 13px;
  border: 0.5px solid $progress-border;
  border-radius: $radius-progress;
  background:
    linear-gradient(rgb(176, 176, 176), rgb(207, 207, 207)),
    linear-gradient(rgb(190, 190, 190) 0%, rgb(213, 213, 213) 15%, rgb(230, 230, 230) 50%, rgb(235, 235, 235) 100%);
  overflow: hidden;
  position: relative;

  // Progress bar fill - uses progress.png image pattern with animation
  .bar {
    height: 100%;
    background-image: url('../images/progress.png');
    background-repeat: repeat-x;
    background-size: auto 100%;
    border-right: 0.5px solid rgb(161, 161, 161);
    border-radius: $radius-small;
    animation: aqua-progress-scroll 1s linear infinite;
  }

  // Indeterminate state - diagonal candy cane stripes
  // JavaFX: LinearGradient(startX, 0.45, endX, 0.0, proportional=true, REFLECT, [50% blue, 50% gray])
  // The gradient animates startX/endX from 0 to 0.82 over 2 seconds
  &.indeterminate {
    // Three layers as in JavaFX:
    // 1. Base gray gradient
    // 2. Animated diagonal stripes (blue/gray)
    // 3. Glass highlight overlay
    background:
      // Layer 3: Glass highlight overlay
      linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0.7) 5%,
        rgba(255, 255, 255, 0.55) 5%,
        rgba(255, 255, 255, 0.1) 50%,
        rgba(255, 255, 255, 0) 50%,
        rgba(255, 255, 255, 0) 60%,
        rgba(255, 255, 255, 0.4) 85%,
        rgba(245, 245, 245, 0.7) 100%
      ),
      // Layer 2: Diagonal candy cane stripes
      repeating-linear-gradient(
        135deg,
        rgb(84, 169, 239) 0px,
        rgb(84, 169, 239) 5px,
        rgb(236, 236, 236) 5px,
        rgb(236, 236, 236) 10px
      ),
      // Layer 1: Base gray gradient
      linear-gradient(rgb(176, 176, 176), rgb(207, 207, 207));
    background-size: 100% 100%, 14px 14px, 100% 100%;
    animation: aqua-indeterminate 2s linear infinite;
    border-radius: $radius-progress;

    .bar {
      display: none;
    }
  }

  // Disabled state
  &.disabled {
    @include disabled-state;
  }
}

// Animation for determinate progress bar (scrolling image pattern)
@keyframes aqua-progress-scroll {
  from {
    background-position: 0 0;
  }
  to {
    background-position: -38px 0;
  }
}

// Animation for indeterminate progress bar (moving diagonal stripes)
@keyframes aqua-indeterminate {
  from {
    background-position: 0 0, 0 0, 0 0;
  }
  to {
    background-position: 0 0, 200px 0, 0 0;
  }
}

// ============================================
// CIRCULAR PROGRESS INDICATOR (Determinate)
// Matches JavaFX ProgressIndicator exactly
// Uses --progress as a number 0-100 (e.g., style="--progress: 75")
// ============================================

.aqua-progress-indicator {
  width: 32px;
  height: 32px;
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  // Outer ring (track) - matches JavaFX .determinate-indicator > .indicator
  .indicator {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: linear-gradient(
      to bottom,
      rgb(190, 190, 190) 0%,
      rgb(213, 213, 213) 15%,
      rgb(230, 230, 230) 50%,
      rgb(235, 235, 235) 100%
    );
    border: 0.5px solid rgb(176, 176, 176);
  }

  // Progress fill (pie style using conic-gradient)
  .progress {
    position: absolute;
    width: calc(100% - 4px);
    height: calc(100% - 4px);
    border-radius: 50%;
    background: conic-gradient(
      from -90deg,
      rgb(90, 192, 246) 0deg,
      rgb(84, 170, 240) calc(var(--progress, 0) * 3.6deg),
      transparent calc(var(--progress, 0) * 3.6deg),
      transparent 360deg
    );
    border: 0.5px solid rgb(208, 208, 208);

    // Inner hole to make it a ring
    &::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      right: 2px;
      bottom: 2px;
      background: linear-gradient(to bottom, rgb(250, 250, 250), rgb(255, 255, 255));
      border-radius: 50%;
    }
  }

  // Tick mark (shown at 100%) - matches JavaFX .tick shape
  .tick {
    display: none;
    position: absolute;
    width: 10px;
    height: 10px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 10'%3E%3Cpath d='M1 5L4.5 9L11 1' stroke='white' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-size: contain;
    z-index: 1;
  }

  // Percentage text - matches JavaFX .percentage font-size
  .percentage {
    font-size: 0.916667em;
    color: $aqua-text;
    z-index: 1;
  }

  // Complete state - show tick, hide percentage
  &.complete {
    .progress {
      background: radial-gradient(
        circle,
        rgb(84, 170, 240),
        rgb(90, 192, 246)
      );
    }

    .tick {
      display: block;
    }

    .percentage {
      display: none;
    }
  }

  // Disabled
  &.disabled {
    @include disabled-state;
  }
}

// ============================================
// SPINNER INDICATOR (Indeterminate - 12 segments)
// Matches JavaFX ProgressIndicator:indeterminate
// ============================================

.aqua-spinner-indicator {
  width: 20px;
  height: 20px;
  position: relative;
  animation: aqua-spin 1s steps(12) infinite;

  // Each segment is positioned around center
  .segment {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;

    // The actual segment shape
    &::before {
      content: '';
      position: absolute;
      width: 2px;
      height: 5px;
      background: rgb(95, 95, 98);
      border-radius: 1px;
      left: 50%;
      top: 0;
      margin-left: -1px;
      box-shadow: inset 0 0 0 0.5px rgb(122, 122, 125);
    }
  }

  // Position each segment with rotation
  .segment:nth-child(1) { transform: rotate(0deg); }
  .segment:nth-child(2) { transform: rotate(30deg); }
  .segment:nth-child(3) { transform: rotate(60deg); }
  .segment:nth-child(4) { transform: rotate(90deg); }
  .segment:nth-child(5) { transform: rotate(120deg); }
  .segment:nth-child(6) { transform: rotate(150deg); }
  .segment:nth-child(7) { transform: rotate(180deg); }
  .segment:nth-child(8) { transform: rotate(210deg); }
  .segment:nth-child(9) { transform: rotate(240deg); }
  .segment:nth-child(10) { transform: rotate(270deg); }
  .segment:nth-child(11) { transform: rotate(300deg); }
  .segment:nth-child(12) { transform: rotate(330deg); }

  // Opacity gradient for spinning effect
  .segment:nth-child(1)::before { opacity: 1.0; }
  .segment:nth-child(2)::before { opacity: 0.92; }
  .segment:nth-child(3)::before { opacity: 0.83; }
  .segment:nth-child(4)::before { opacity: 0.75; }
  .segment:nth-child(5)::before { opacity: 0.67; }
  .segment:nth-child(6)::before { opacity: 0.58; }
  .segment:nth-child(7)::before { opacity: 0.50; }
  .segment:nth-child(8)::before { opacity: 0.42; }
  .segment:nth-child(9)::before { opacity: 0.33; }
  .segment:nth-child(10)::before { opacity: 0.25; }
  .segment:nth-child(11)::before { opacity: 0.17; }
  .segment:nth-child(12)::before { opacity: 0.08; }
}

// Larger spinner variant
.aqua-spinner-indicator.large {
  width: 32px;
  height: 32px;

  .segment::before {
    width: 3px;
    height: 8px;
    margin-left: -1.5px;
  }
}

@keyframes aqua-spin {
  to {
    transform: rotate(360deg);
  }
}
